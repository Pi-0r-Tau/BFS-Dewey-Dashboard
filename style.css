/* ─── TOKENS ─────────────────────────────────────────────── */
:root {
  --page-bg:    #f3f2f1;
  --card-bg:    #ffffff;
  --header-bg:  #0b0c0c;
  --blue:       #1d70b8;
  --blue-dark:  #003078;
  --blue-light: #d2e2f1;
  --green:      #00703c;
  --green-dark: #005a30;
  --red:        #d4351c;
  --purple:     #4c2c92;
  --orange:     #f47738;
  --teal:       #28a197;
  --yellow:     #ffdd00;
  --text:       #0b0c0c;
  --text-2:     #505a5f;
  --text-3:     #6f777b;
  --border:     #b1b4b6;
  --border-dk:  #0b0c0c;
  --font:       "GDS Transport","Helvetica Neue",Arial,sans-serif;
  --mono:       "Courier New",Courier,monospace;
  --r:          4px;
  /* chart colours — all AA on white */
  --c1:#1d70b8; --c2:#00703c; --c3:#d4351c; --c4:#f47738;
  --c5:#4c2c92; --c6:#28a197; --c7:#0b0c0c; --c8:#b58840; --c9:#5694ca;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { height: 100%; }
body { font-family: var(--font); font-size: 16px; line-height: 1.5; color: var(--text); background: var(--page-bg); -webkit-font-smoothing: antialiased; }
a { color: var(--blue); }
a:hover { color: var(--blue-dark); }
button { font-family: var(--font); cursor: pointer; }

/* ─── SKIP LINK ──────────────────────────────────────────── */
.skip-link { position:absolute; top:-999px; left:0; background:var(--yellow); color:var(--text); font-weight:700; font-size:16px; padding:10px 15px; z-index:1000; text-decoration:none; }
.skip-link:focus { top:0; outline:3px solid var(--text); }

/* ─── FOCUS ──────────────────────────────────────────────── */
:focus-visible { outline:3px solid var(--yellow); outline-offset:0; box-shadow:inset 0 0 0 2px var(--text); }
:focus:not(:focus-visible) { outline:none; box-shadow:none; }

/* ─── HEADER ─────────────────────────────────────────────── 
.govuk-header_link contrast ration issue
WCAG 1.4.3 */
.govuk-header { background:var(--header-bg); border-bottom:10px solid var(--blue); }
.govuk-header__inner { max-width:1280px; margin:0 auto; padding:12px 30px; display:flex; align-items:center; gap:20px; flex-wrap:wrap; }
.govuk-header__logotype { display:inline-flex; align-items:center; gap:8px; text-decoration:none; }
.govuk-header__crown { width:36px; height:32px; fill:#fff; flex-shrink:0; }
.govuk-header__logotype-text { color:#fff; font-size:30px; font-weight:700; line-height:1; letter-spacing:1px; }
.govuk-header__sep { width:1px; height:28px; background:rgba(255,255,255,.3); }
.govuk-header__service { color:#fff; font-size:19px; text-decoration:none; }
.govuk-header__service:hover { text-decoration:underline; color:#fff; }
.govuk-header__link { color:#fff; font-size:16px; text-decoration:none; }
.govuk-header__link:hover { text-decoration:underline; color:#fff; }

/* ─── ISBN HERO BAND ─────────────────────────────────────── */
.isbn-band {
  background: var(--blue-dark);
  border-bottom: 4px solid var(--blue);
}
.isbn-band__inner {
  max-width: 1280px;
  margin: 0 auto;
  padding: 20px 30px;
}
.isbn-band__heading {
  color: #fff;
  font-size: 19px;
  font-weight: 700;
  margin-bottom: 12px;
}
.isbn-band__hint {
  color: #b1c7d9;
  font-size: 14px;
  margin-bottom: 12px;
  display: block;
}
.isbn-form {
  display: flex;
  gap: 0;
  max-width: 540px;
  flex-wrap: wrap;
}
.isbn-input-wrap { flex: 1; min-width: 200px; position: relative; }
.isbn-input {
  display: block;
  width: 100%;
  font-family: var(--font);
  font-size: 18px;
  padding: 9px 14px;
  border: 3px solid #fff;
  border-right: none;
  background: #fff;
  color: var(--text);
  border-radius: 0;
  outline: none;
  letter-spacing: .05em;
}
.isbn-input:focus { outline: 3px solid var(--yellow); outline-offset: 0; box-shadow: inset 0 0 0 2px var(--text); }
.isbn-input::placeholder { color: var(--text-3); font-size: 16px; letter-spacing: 0; }
.isbn-search-btn {
  background: var(--yellow);
  color: var(--text);
  font-family: var(--font);
  font-size: 18px;
  font-weight: 700;
  padding: 9px 20px;
  border: 3px solid var(--text);
  border-left: none;
  border-radius: 0;
  white-space: nowrap;
  box-shadow: 0 2px 0 #594200;
  transition: background .1s;
}
.isbn-search-btn:hover { background: #e6c800; }
.isbn-search-btn:active { transform: translateY(2px); box-shadow: none; }
.isbn-search-btn:focus { outline: 3px solid var(--blue); outline-offset: 0; }
.isbn-clear-btn {
  background: transparent;
  border: none;
  color: #b1c7d9;
  font-size: 14px;
  padding: 4px 0;
  margin-top: 8px;
  text-decoration: underline;
  display: none;
  cursor: pointer;
}
.isbn-clear-btn:hover { color: #fff; }

/* ISBN result panel */
.isbn-result {
  margin-top: 16px;
  max-width: 800px;
  display: none;
}
.isbn-result__found {
  background: var(--card-bg);
  border-left: 5px solid var(--green);
  padding: 16px 20px;
}
.isbn-result__not-found {
  background: var(--card-bg);
  border-left: 5px solid var(--red);
  padding: 14px 20px;
  color: var(--text);
}
.isbn-result__searching {
  color: #b1c7d9;
  font-size: 15px;
  padding: 10px 0;
}
.isbn-result__title { font-size: 19px; font-weight: 700; color: var(--text); margin-bottom: 4px; }
.isbn-result__title a { color: var(--blue); }
.isbn-result__meta-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 10px 20px;
  margin-top: 12px;
}
.isbn-meta-item {}
.isbn-meta-label { font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: .05em; color: var(--text-3); margin-bottom: 2px; }
.isbn-meta-value { font-size: 15px; color: var(--text); }
.isbn-meta-value.mono { font-family: var(--mono); font-size: 13px; }
.isbn-progress { font-size: 14px; color: #b1c7d9; margin-top: 6px; }
.isbn-progress-bar { height: 4px; background: rgba(255,255,255,.2); border-radius: 2px; margin-top: 8px; overflow: hidden; max-width: 540px; }
.isbn-progress-fill { height: 100%; background: var(--yellow); width: 0; transition: width .3s; border-radius: 2px; }
.isbn-stop-btn {
  background: transparent;
  border: 1px solid rgba(255,255,255,.4);
  color: #b1c7d9;
  font-family: var(--font);
  font-size: 13px;
  font-weight: 600;
  padding: 4px 12px;
  border-radius: var(--r);
  margin-top: 8px;
  cursor: pointer;
}
.isbn-stop-btn:hover { background: rgba(255,255,255,.1); color: #fff; }
.govuk-tag { display:inline-block; background:var(--blue); color:#fff; font-size:13px; font-weight:700; letter-spacing:1px; padding:2px 8px; text-transform:uppercase; border-radius:var(--r); white-space:nowrap; }
.govuk-tag--green  { background:var(--green); }
.govuk-tag--format { font-size:12px; font-weight:600; padding:1px 6px; border-radius:var(--r); }
.govuk-tag--ebook    { background:#e8d5f5; color:var(--purple); }
.govuk-tag--hardback { background:#fde8d3; color:#73391a; }
.govuk-tag--paper    { background:#d4edda; color:var(--green-dark); }
.govuk-tag--other    { background:var(--page-bg); color:var(--text-2); border:1px solid var(--border); }

/* ─── PHASE BANNER ───────────────────────────────────────── */
.govuk-phase-banner { border-bottom:1px solid var(--border); background:var(--card-bg); }
.govuk-phase-banner__inner { max-width:1280px; margin:0 auto; padding:8px 30px; display:flex; align-items:center; gap:12px; font-size:14px; color:var(--text-2); flex-wrap:wrap; }
.govuk-phase-banner__text a { color:var(--blue); }

/* ─── CONTROLS BAND ──────────────────────────────────────── */
.controls-band {
  background: var(--card-bg);
  border-bottom: 1px solid var(--border);
}
.controls-band__inner {
  max-width: 1280px;
  margin: 0 auto;
  padding: 20px 30px;
}
.controls-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 24px 40px;
  align-items: flex-start;
}
.controls-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.controls-group__title {
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  text-transform: uppercase;
  letter-spacing: .06em;
  margin: 0 0 4px 0;
}
.controls-hint {
  font-size: 13px;
  margin: 0 0 8px 0;
}
.controls-group--dates {
  flex: 1;
  min-width: 280px;
}
.controls-dates {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-end;
  gap: 12px;
}
.controls-date-field {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.controls-date-field .govuk-label {
  margin-bottom: 0;
  font-size: 14px;
}
.controls-date-field .govuk-input {
  width: 150px;
}
.controls-quick {
  display: flex;
  gap: 6px;
  align-items: flex-end;
}
.controls-quick .govuk-button--secondary {
  flex: none;
  min-width: auto;
  padding: 6px 10px;
  font-size: 13px;
}
.controls-load-btn {
  margin: 0;
  padding: 8px 20px;
  white-space: nowrap;
}
.controls-group--stats {
  min-width: 180px;
}
.controls-group--stats .sstat-list {
  display: flex;
  flex-direction: row;
  gap: 12px;
}
.controls-group--stats .sstat {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 2px;
  padding: 8px 12px;
  min-width: 100px;
  background: var(--page-bg);
  border-left: 4px solid var(--blue);
}
.controls-group--stats .sstat-label {
  font-size: 11px;
  color: var(--text-2);
}
.controls-group--stats .sstat-value {
  font-size: 16px;
  font-weight: 700;
  color: var(--text);
}
.controls-group--filters {
  flex: 1;
  min-width: 300px;
}
.controls-filters {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: flex-end;
}
.controls-filter-field {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.controls-filter-field .govuk-label {
  margin-bottom: 0;
  font-size: 14px;
}
.controls-filter-field .govuk-input,
.controls-filter-field .govuk-select {
  width: 160px;
}
.controls-filter-field--search .govuk-input {
  width: 220px;
}
.controls-alerts {
  margin-top: 12px;
}
.controls-alerts:empty {
  display: none;
}

/* ─── PAGE LAYOUT ────────────────────────────────────────── */
.govuk-width-container { max-width:1280px; margin:0 auto; padding:0 30px; }
.govuk-main-wrapper { padding:30px 0 80px; }

/* ─── FORM ELEMENTS ──────────────────────────────────────── */
.govuk-label { display:block; font-size:16px; font-weight:700; color:var(--text); margin-bottom:4px; }
.govuk-hint { font-size:14px; color:var(--text-3); margin-bottom:6px; display:block; }
.govuk-input, .govuk-select {
  font-family:var(--font); font-size:16px; display:block; width:100%;
  padding:6px 8px; border:2px solid var(--border-dk); border-radius:0;
  background:var(--card-bg); color:var(--text); appearance:none; -webkit-appearance:none;
}
.govuk-input:focus, .govuk-select:focus { outline:3px solid var(--yellow); outline-offset:0; box-shadow:inset 0 0 0 2px var(--text); }
.govuk-form-group { margin-bottom:20px; }
.govuk-fieldset__legend { font-size:19px; font-weight:700; margin-bottom:15px; }
.govuk-fieldset__legend--s { font-size:14px; font-weight:700; color:var(--text-2); text-transform:uppercase; letter-spacing:.06em; }
.quick-row { display:flex; gap:8px; margin-bottom:15px; flex-wrap:wrap; }
.govuk-button--secondary { flex:1; min-width:60px; background:var(--card-bg); border:2px solid var(--border-dk); color:var(--text); font-family:var(--font); font-size:14px; font-weight:700; padding:6px 4px; cursor:pointer; border-radius:0; transition:background .1s; text-align:center; }
.govuk-button--secondary:hover { background:var(--page-bg); }
.govuk-button--secondary:focus { outline:3px solid var(--yellow); outline-offset:0; box-shadow:inset 0 0 0 2px var(--text); }
.govuk-button { display:block; width:100%; font-family:var(--font); font-size:18px; font-weight:700; padding:10px 12px; background:var(--green); color:#fff; border:none; border-radius:0; cursor:pointer; box-shadow:0 2px 0 var(--green-dark); text-align:center; transition:background .1s; margin-top:8px; }
.govuk-button:hover { background:var(--green-dark); }
.govuk-button:active { transform:translateY(2px); box-shadow:none; }
.govuk-button:focus { outline:3px solid var(--yellow); outline-offset:0; box-shadow:inset 0 0 0 2px var(--text); }
.govuk-button:disabled { background:var(--border); box-shadow:0 2px 0 var(--text-3); cursor:not-allowed; transform:none; }
.govuk-button--small { font-family:var(--font); font-size:14px; font-weight:700; padding:6px 12px; background:var(--card-bg); color:var(--text); border:2px solid var(--border-dk); cursor:pointer; border-radius:0; white-space:nowrap; }
.govuk-button--small:hover { background:var(--page-bg); }
.govuk-button--small:focus { outline:3px solid var(--yellow); outline-offset:0; box-shadow:inset 0 0 0 2px var(--text); }

/* ─── PROGRESS ───────────────────────────────────────────── */
#progress-wrap { margin-top:15px; display:none; }
[role="progressbar"] { height:6px; background:var(--border); border-radius:3px; overflow:hidden; }
.prog-fill { height:100%; background:var(--blue); width:0; transition:width .3s; }
.prog-label { font-size:13px; color:var(--text-3); margin-top:5px; }

/* ─── ALERTS ─────────────────────────────────────────────── */
.govuk-error-summary { border:4px solid var(--red); padding:15px 20px; margin-bottom:20px; background:var(--card-bg); display:none; }
.govuk-error-summary__title { font-size:18px; font-weight:700; color:var(--red); margin-bottom:8px; }
.govuk-error-summary__body { font-size:15px; }
.govuk-warning-text { border-left:4px solid var(--orange); padding:10px 15px; background:#fff7e6; font-size:14px; margin-bottom:15px; display:none; }

/* ─── SIDEBAR STATS ──────────────────────────────────────── */
#sidebar-stats { display:none; }
.sstat-list { display:flex; flex-direction:column; gap:8px; }
.sstat { display:flex; justify-content:space-between; align-items:baseline; padding:8px 10px; background:var(--page-bg); border-left:4px solid var(--blue); }
.sstat-label { font-size:13px; color:var(--text-2); }
.sstat-value { font-size:18px; font-weight:700; color:var(--text); }

/* ─── TYPOGRAPHY ─────────────────────────────────────────── */
.govuk-heading-xl { font-size:48px; font-weight:700; line-height:1.04; margin-bottom:20px; }
.govuk-heading-l  { font-size:36px; font-weight:700; line-height:1.11; margin-bottom:15px; }
.govuk-heading-m  { font-size:24px; font-weight:700; line-height:1.25; margin-bottom:10px; }
.govuk-heading-s  { font-size:18px; font-weight:700; line-height:1.4; margin-bottom:5px; }
.govuk-body-l     { font-size:19px; line-height:1.315; }
.govuk-body       { font-size:16px; line-height:1.5; }
.govuk-body-s     { font-size:14px; line-height:1.4; color:var(--text-2); }

/* ─── EMPTY STATE ────────────────────────────────────────── */
#empty-state { padding:60px 25px; text-align:center; background:var(--card-bg); border:1px solid var(--border); border-radius:var(--r); }
#empty-state p { color:var(--text-2); font-size:18px; margin-top:15px; }
#empty-state small { font-size:14px; color:var(--text-3); }

/* ─── METRICS ────────────────────────────────────────────── */
#metrics { display:grid; grid-template-columns:repeat(3,1fr); gap:16px; margin-bottom:30px; display:none; }
.metric { background:var(--card-bg); border:1px solid var(--border); border-top:5px solid var(--m-accent,var(--blue)); padding:15px 20px; }
.metric-val { font-size:36px; font-weight:800; line-height:1; letter-spacing:-.5px; color:var(--text); }
.metric-lbl { font-size:13px; color:var(--text-2); margin-top:6px; font-weight:600; text-transform:uppercase; letter-spacing:.05em; }
.metric-sub { font-size:12px; color:var(--text-3); margin-top:3px; }

/* ─── CHART GRID ─────────────────────────────────────────── */
#chart-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:16px; margin-bottom:30px; display:none; }
.chart-panel { background:var(--card-bg); border:1px solid var(--border); border-radius:var(--r); overflow:hidden; }
.chart-panel.drillable { cursor:pointer; }
.chart-panel.drillable:hover .panel-head { background:var(--blue-light); }
.chart-panel.span2 { grid-column:span 2; }
.panel-head { padding:12px 16px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; background:var(--page-bg); transition:background .12s; flex-wrap:wrap; gap:8px; }
.panel-title { font-size:14px; font-weight:700; color:var(--text); text-transform:uppercase; letter-spacing:.06em; }
.panel-hint { font-size:12px; color:var(--blue); font-weight:600; }
.panel-meta { font-size:12px; color:var(--text-2); }
.panel-body { padding:16px; }

/* ─── BAR LIST ───────────────────────────────────────────── */
.bar-item {
  list-style: none;
}
.bar-button { width: 100%; background: none; border: none; padding: 0; cursor: pointer; text-align: left; font-family: inherit; font-size: inherit;}
.bar-button:hover .bar-name {
  color: var(--blue);
  text-decoration: underline;
}
.bar-button:focus {
  outline: 3px solid var(--yellow);
  outline-offset: 0;
  box-shadow: inset 0 0 0 2px var(--text);
}
.bar-row-top { display:flex; justify-content:space-between; margin-bottom:4px; }
.bar-name { font-size:13px; color:var(--text); font-weight:500; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:75%; }
.bar-count { font-size:13px; color:var(--text-2); font-weight:700; }
.bar-track { height:8px; background:var(--page-bg); border-radius:2px; overflow:hidden; border:1px solid var(--border); }
.bar-fill { height:100%; border-radius:1px; transition:width .5s ease; }

/* ─── TABLE ──────────────────────────────────────────────── */
#table-section { background:var(--card-bg); border:1px solid var(--border); border-radius:var(--r); overflow:hidden; display:none; }
.table-toolbar { padding:12px 16px; border-bottom:1px solid var(--border); display:flex; flex-wrap:wrap; align-items:center; gap:12px; background:var(--page-bg); }
.table-toolbar-title { font-size:14px; font-weight:700; text-transform:uppercase; letter-spacing:.06em; flex:1; min-width:120px; }
.result-count { font-size:13px; color:var(--text-2); }
.govuk-table-wrap { overflow-x:auto; -webkit-overflow-scrolling:touch; }
.govuk-table { width:100%; border-collapse:collapse; font-size:14px; min-width:700px; }
.govuk-table__head th { padding:10px 14px; text-align:left; font-size:12px; font-weight:700; color:var(--text-2); text-transform:uppercase; letter-spacing:.05em; border-bottom:2px solid var(--border-dk); background:var(--page-bg); cursor:pointer; white-space:nowrap; user-select:none; vertical-align:bottom; }
.govuk-table__head th:hover { color:var(--blue); }
.govuk-table__head th[aria-sort="ascending"]::after  { content:" ↑"; color:var(--blue); }
.govuk-table__head th[aria-sort="descending"]::after { content:" ↓"; color:var(--blue); }
.govuk-table__head th[aria-sort="none"]::after { content:" ↕"; color:var(--border); }
.govuk-table__body tr { border-bottom:1px solid var(--border); }
.govuk-table__body tr:hover { background:var(--blue-light); }
.govuk-table__body td { padding:10px 14px; vertical-align:middle; }
.td-title { color:var(--text); font-weight:600; max-width:240px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.td-title a { color:var(--blue); }
.td-title a:hover { color:var(--blue-dark); }
.td-body  { color:var(--text-2); max-width:180px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.td-mono  { font-family:var(--mono); font-size:12px; color:#505a5f; }
.td-price { color:var(--green); font-weight:700; white-space:nowrap; }

/* ─── PAGINATION ─────────────────────────────────────────── */
.govuk-pagination { display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-top:1px solid var(--border); flex-wrap:wrap; gap:10px; }
.govuk-pagination__info { font-size:14px; color:var(--text-2); }
.govuk-pagination__list { display:flex; gap:4px; list-style:none; flex-wrap:wrap; }
.govuk-pagination__item button { font-family:var(--font); font-size:14px; font-weight:700; padding:6px 11px; background:var(--card-bg); border:1px solid var(--border); color:var(--blue); cursor:pointer; border-radius:var(--r); min-width:32px; text-align:center; }
.govuk-pagination__item button:hover { background:var(--blue-light); }
.govuk-pagination__item button:focus { outline:3px solid var(--yellow); outline-offset:0; box-shadow:inset 0 0 0 2px var(--text); }
.govuk-pagination__item--current button { background:var(--blue); color:#fff; border-color:var(--blue); }
.govuk-pagination__item--ellipsis { padding:6px 4px; font-size:14px; color:var(--text-3); align-self:center; }

/* ─── DRILL MODAL ────────────────────────────────────────── */
#drill-overlay { position:fixed; inset:0; background:rgba(0,0,0,.55); z-index:9000; display:none; align-items:center; justify-content:center; padding:16px; }
#drill-overlay.open { display:flex; }
#drill-modal { background:var(--card-bg); border-top:6px solid var(--blue); width:100%; max-width:960px; max-height:88vh; display:flex; flex-direction:column; box-shadow:0 8px 40px rgba(0,0,0,.25); }
.drill-modal-head { padding:16px 20px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; flex-shrink:0; background:var(--page-bg); flex-wrap:wrap; gap:10px; }
.drill-modal-title { font-size:18px; font-weight:700; }
.drill-modal-close { font-family:var(--font); background:var(--card-bg); border:2px solid var(--border-dk); color:var(--text); font-size:16px; font-weight:700; padding:4px 12px; cursor:pointer; border-radius:0; }
.drill-modal-close:hover { background:var(--page-bg); }
.drill-modal-close:focus { outline:3px solid var(--yellow); outline-offset:0; box-shadow:inset 0 0 0 2px var(--text); }
.drill-modal-body { overflow-y:auto; padding:20px; flex:1; }

/* ─── FOOTER ─────────────────────────────────────────────── */
.govuk-footer { background:var(--page-bg); border-top:1px solid var(--border); padding:30px 0; margin-top:40px; }
.govuk-footer__inner { max-width:1280px; margin:0 auto; padding:0 30px; display:flex; flex-wrap:wrap; justify-content:space-between; gap:20px; }
.govuk-footer__links { list-style:none; display:flex; flex-wrap:wrap; gap:10px 20px; }
.govuk-footer__link { color:var(--blue); font-size:15px; }
.govuk-footer__meta { font-size:14px; color:#333333; }

/* ─── UTILITY ────────────────────────────────────────────── */
.sr-only { position:absolute!important; width:1px!important; height:1px!important; overflow:hidden!important; clip:rect(0,0,0,0)!important; white-space:nowrap!important; }

/* ─── RESPONSIVE ─────────────────────────────────────────── */

/* Fluid images and canvas */
img, canvas, svg {
  max-width: 100%;
  height: auto;
}

/* Large tablets and below (1024px) */
@media (max-width:1024px) {
  #metrics { grid-template-columns:repeat(2,1fr); }
  
  .govuk-header__inner,
  .govuk-phase-banner__inner,
  .isbn-band__inner,
  .controls-band__inner,
  .govuk-width-container,
  .govuk-footer__inner {
    padding-left: 20px;
    padding-right: 20px;
  }
  
  .controls-grid {
    gap: 20px 30px;
  }
}

/* Tablets and below (900px) */
@media (max-width:900px) {
  #metrics { grid-template-columns:repeat(2,1fr); }
  #chart-grid { grid-template-columns:1fr; }
  .chart-panel.span2 { grid-column:1; }
  .isbn-form { flex-direction:column; max-width:100%; }
  .isbn-input { border-right:3px solid #fff; border-bottom:none; }
  .isbn-search-btn { border-left:3px solid var(--text); border-top:none; width:100%; }
  .isbn-input-wrap { min-width:0; width:100%; }
  
  .controls-grid {
    flex-direction: column;
    gap: 20px;
  }
  .controls-group--dates,
  .controls-group--filters {
    width: 100%;
  }
  .controls-group--stats .sstat-list {
    flex-wrap: wrap;
  }
  .controls-filter-field--search .govuk-input {
    width: 100%;
    max-width: 300px;
  }
}

/* Small tablets and large phones (768px) */
@media (max-width:768px) {
  .govuk-main-wrapper { padding:20px 0 50px; }
  
  .govuk-heading-xl { font-size:32px; }
  .govuk-heading-l { font-size:26px; }
  .govuk-heading-m { font-size:20px; }
  
  #metrics { gap:12px; }
  .metric { padding:12px 14px; }
  .metric-val { font-size:26px; }
  .metric-lbl { font-size:12px; }
  
  .panel-body { padding:12px; }
  
  .govuk-table { min-width:600px; }
  
  .govuk-header__inner,
  .govuk-phase-banner__inner,
  .isbn-band__inner,
  .controls-band__inner,
  .govuk-width-container,
  .govuk-footer__inner {
    padding-left: 16px;
    padding-right: 16px;
  }
  
  .controls-band__inner { padding: 16px; }
  .controls-dates { gap: 10px; }
  .controls-date-field .govuk-input { width: 130px; }
  .controls-filters { gap: 10px; }
  .controls-filter-field .govuk-input,
  .controls-filter-field .govuk-select { width: 140px; }
}

/* Phones (600px) */
@media (max-width:600px) {
  .govuk-header__inner { 
    gap:8px; 
    padding:10px 15px;
  }
  .govuk-header__logotype-text { font-size:22px; }
  .govuk-header__service { font-size:15px; }
  .govuk-header__sep { display:none; }
  
  .isbn-band__inner { padding:16px 15px; }
  .isbn-band__heading { font-size:17px; }
  .isbn-input { font-size:16px; padding:10px 12px; }
  .isbn-search-btn { font-size:16px; padding:10px 16px; }
  .isbn-result__meta-grid { grid-template-columns:1fr 1fr; gap:8px 12px; }
  
  .controls-band__inner { padding: 14px 15px; }
  .controls-group__title { font-size: 13px; }
  .controls-dates {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
  }
  .controls-date-field {
    flex-direction: row;
    align-items: center;
    gap: 10px;
  }
  .controls-date-field .govuk-label {
    min-width: 40px;
  }
  .controls-date-field .govuk-input {
    flex: 1;
    width: auto;
  }
  .controls-quick {
    width: 100%;
  }
  .controls-quick .govuk-button--secondary {
    flex: 1;
  }
  .controls-load-btn {
    width: 100%;
  }
  .controls-group--stats .sstat-list {
    flex-direction: row;
    gap: 8px;
  }
  .controls-group--stats .sstat {
    flex: 1;
    min-width: 0;
    padding: 6px 10px;
  }
  .controls-filters {
    flex-direction: column;
    align-items: stretch;
  }
  .controls-filter-field .govuk-input,
  .controls-filter-field .govuk-select,
  .controls-filter-field--search .govuk-input {
    width: 100%;
    max-width: none;
  }
  
  .govuk-phase-banner__inner { font-size:13px; gap:8px; }
  
  .govuk-main-wrapper { padding:20px 0 40px; }
  .govuk-heading-xl { font-size:26px; }
  .govuk-heading-l { font-size:22px; }
  
  #metrics { grid-template-columns:1fr 1fr; gap:10px; }
  .metric { padding:10px 12px; }
  .metric-val { font-size:22px; }
  .metric-sub { font-size:11px; }
  
  #empty-state { padding:35px 18px; }
  #empty-state p { font-size:15px; }
  
  .table-toolbar { padding:10px 12px; gap:8px; }
  .table-toolbar-title { font-size:13px; min-width:auto; }
  .govuk-table__head th { padding:8px 10px; font-size:10px; }
  .govuk-table__body td { padding:8px 10px; font-size:13px; }
  .td-title { max-width:140px; }
  .td-body { max-width:100px; }
  
  .govuk-pagination { padding:10px 12px; flex-direction:column; align-items:stretch; }
  .govuk-pagination__info { text-align:center; }
  .govuk-pagination__list { justify-content:center; }
  .govuk-pagination__item button { padding:6px 10px; font-size:13px; min-width:30px; }
  
  .govuk-footer { padding:20px 0; }
  .govuk-footer__inner { flex-direction:column; gap:12px; }
  .govuk-footer__links { flex-direction:column; gap:8px; }
  
  #drill-modal { max-height:95vh; }
  .drill-modal-head { padding:12px 15px; }
  .drill-modal-title { font-size:16px; }
  .drill-modal-body { padding:15px; }
  
.panel-head { padding:12px 16px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; background:var(--page-bg); transition:background .12s; flex-wrap:wrap; gap:8px; }
.panel-title { font-size:14px; font-weight:700; color:var(--text); text-transform:uppercase; letter-spacing:.06em; }
.panel-hint { font-size:12px; color:var(--blue); font-weight:600; }
.panel-meta { font-size:12px; color:var(--text-2); }
  
  .bar-name { font-size:12px; }
  .bar-count { font-size:12px; }
}

/* Small phones (480px) */
@media (max-width:480px) {
  .govuk-header__logotype-text { font-size:20px; }
  .govuk-header__service { 
    font-size:14px; 
    width:100%; 
    margin-top:4px;
  }
  
  .isbn-result__meta-grid { grid-template-columns:1fr; }
  
  #metrics { grid-template-columns:1fr; }
  .metric-val { font-size:28px; }
  
  .controls-group--stats .sstat-list {
    flex-direction: column;
  }
  .controls-group--stats .sstat {
    flex-direction: row;
    justify-content: space-between;
  }
  
  .govuk-heading-xl { font-size:22px; }
  .govuk-heading-l { font-size:20px; }
  
  .govuk-table { min-width:500px; font-size:12px; }
  .govuk-table__head th { padding:6px 8px; font-size:9px; }
  .govuk-table__body td { padding:6px 8px; font-size:12px; }
  .td-title { max-width:120px; }
  .td-body { max-width:80px; }
  .td-mono { font-size:10px; }
  
  .govuk-button { font-size:16px; padding:10px; }
}
@media (max-width:360px) {
  .govuk-header__inner,
  .govuk-phase-banner__inner,
  .isbn-band__inner,
  .controls-band__inner,
  .govuk-width-container,
  .govuk-footer__inner {
    padding-left: 12px;
    padding-right: 12px;
  }
  
  .govuk-header__logotype-text { font-size:18px; }
  .isbn-input { font-size:14px; }
  .isbn-search-btn { font-size:14px; }
  
  .govuk-heading-xl { font-size:20px; }
  .metric-val { font-size:24px; }
}
